pipeline{
	agent{ label 'master'}

		stages{
			stage('test'){
				steps{
					bat "mvn clean compile test"
				}
			}
			stage('nexus'){
				steps{
					script{
						dir("build_java"){
							def pom = readMavenPom file: "pom.xml";
						
							dir("target"){
								nexusArtifactUploader(
									nexusVersion: 'nexus3',
									protocol: 'http',
									nexusUrl: 'localhost:8081',
									groupId: pom.groupId,
									version: pom.version,
									repository: 'Product',
									creadentialsId: 'nexuscredentiales',
									artifacts: [
										[artifactId: pom.artifactId,
										classifier: '',
										file: '',
										type: pom.packaging]
									]
								)
							}
						}	
					}
				}
			}
			
		}
}







